<!DOCTYPE html>
<html>
<head>
    <title>Student Information Management System</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea, #764ba2);
            margin: 0;
            padding: 20px;
            color: white;
        }

        h1 {
            text-align: center;
        }

        .container {
            background: white;
            color: black;
            padding: 20px;
            border-radius: 15px;
            max-width: 900px;
            margin: auto;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        input {
            padding: 8px;
            margin: 5px;
            width: 150px;
        }

        button {
            padding: 8px 12px;
            margin: 5px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        .add { background: #28a745; color: white; }
        .search { background: #17a2b8; color: white; }
        .exit { background: #dc3545; color: white; }

        table {
            width: 100%;
            margin-top: 15px;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        th {
            background: #667eea;
            color: white;
        }
    </style>
</head>

<body>

<h1>Student Information Management System</h1>

<div class="container">

    <!-- INPUT SECTION -->
    <input type="text" id="studentId" placeholder="Student ID">
    <input type="text" id="fullName" placeholder="Full Name">
    <input type="text" id="course" placeholder="Course">
    <input type="text" id="yearLevel" placeholder="Year Level">
    <input type="number" id="age" placeholder="Age">

    <br>

    <button class="add" onclick="addStudent()">Add Student</button>
    <button class="search" onclick="searchStudent()">Search</button>
    <button class="exit" onclick="exitSystem()">Exit</button>

    <!-- TABLE DISPLAY -->
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Course</th>
                <th>Year</th>
                <th>Age</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="studentTable"></tbody>
    </table>

</div>

<!-- Firebase + JavaScript -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-app.js";
    import { getDatabase, ref, set, get, child, update, remove } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-database.js";

    // Firebase configuration (your code)
    const firebaseConfig = {
      apiKey: "AIzaSyCARWtnX9DZw-9e0wqoaXPf48pY5wO8zSA",
      authDomain: "cc01niharry.firebaseapp.com",
      databaseURL: "https://cc01niharry-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "cc01niharry",
      storageBucket: "cc01niharry.firebasestorage.app",
      messagingSenderId: "714955079966",
      appId: "1:714955079966:web:3286289beb5051f146490f"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    const studentTable = document.getElementById("studentTable");

    // ADD STUDENT
    window.addStudent = function() {
        const id = document.getElementById("studentId").value;
        const name = document.getElementById("fullName").value;
        const course = document.getElementById("course").value;
        const year = document.getElementById("yearLevel").value;
        const age = document.getElementById("age").value;

        if (!id || !name) { alert("Student ID and Name are required!"); return; }

        set(ref(database, 'students/' + id), { id, name, course, year, age })
            .then(() => {
                alert("Student added!");
                displayStudents();
                clearFields();
            })
            .catch(error => alert("Error: " + error));
    };

    // DISPLAY STUDENTS
    window.displayStudents = function() {
        get(child(ref(database), 'students')).then(snapshot => {
            studentTable.innerHTML = "";
            if(snapshot.exists()) {
                const data = snapshot.val();
                Object.values(data).forEach(stu => {
                    studentTable.innerHTML += `
                        <tr>
                            <td>${stu.id}</td>
                            <td>${stu.name}</td>
                            <td>${stu.course}</td>
                            <td>${stu.year}</td>
                            <td>${stu.age}</td>
                            <td>
                                <button onclick="editStudent('${stu.id}')">Edit</button>
                                <button onclick="deleteStudent('${stu.id}')">Delete</button>
                            </td>
                        </tr>
                    `;
                });
            }
        }).catch(error => console.error(error));
    };

    // SEARCH STUDENT
    window.searchStudent = function() {
        const searchValue = prompt("Enter Student ID or Name:").toLowerCase();
        get(child(ref(database), 'students')).then(snapshot => {
            let found = false;
            if(snapshot.exists()) {
                Object.values(snapshot.val()).forEach(stu => {
                    if(stu.id.toLowerCase() === searchValue || stu.name.toLowerCase() === searchValue) {
                        alert(`Student Found:
ID: ${stu.id}
Name: ${stu.name}
Course: ${stu.course}
Year: ${stu.year}
Age: ${stu.age}`);
                        found = true;
                    }
                });
            }
            if(!found) alert("Student not found.");
        });
    };

    // EDIT STUDENT
    window.editStudent = function(id) {
        const newCourse = prompt("Enter new Course:");
        const newYear = prompt("Enter new Year Level:");
        const newAge = prompt("Enter new Age?");
        const updates = {};
        if(newCourse) updates['course'] = newCourse;
        if(newYear) updates['year'] = newYear;
        if(newAge) updates['age'] = newAge;
        update(ref(database, 'students/' + id), updates)
            .then(() => displayStudents())
            .catch(error => alert("Error: " + error));
    };

    // DELETE STUDENT
    window.deleteStudent = function(id) {
        if(confirm("Delete this student?")) {
            remove(ref(database, 'students/' + id))
                .then(() => displayStudents())
                .catch(error => alert("Error: " + error));
        }
    };

    // EXIT SYSTEM (CLEAR ALL)
    window.exitSystem = function() {
        if(confirm("Clear all student records?")) {
            remove(ref(database, 'students'))
                .then(() => displayStudents())
                .catch(error => alert("Error: " + error));
        }
    };

    // CLEAR INPUTS
    function clearFields() {
        document.getElementById("studentId").value = "";
        document.getElementById("fullName").value = "";
        document.getElementById("course").value = "";
        document.getElementById("yearLevel").value = "";
        document.getElementById("age").value = "";
    }

    // LOAD STUDENTS ON PAGE LOAD
    displayStudents();

</script>

</body>
</html>